(this["webpackJsonpthe-address-book"]=this["webpackJsonpthe-address-book"]||[]).push([[0],{110:function(e,t,n){e.exports={clientsList:"ClientsList_clientsList__25fCe"}},134:function(e,t,n){},135:function(e,t,n){},164:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(29),c=n.n(r),s=(n(134),n(135),n(207)),i=n(221),o=n(223),l=n(224),d=n(225),u=n(1);function j(){return Object(u.jsx)(i.a,{position:"static",children:Object(u.jsxs)(o.a,{variant:"dense",children:[Object(u.jsx)(l.a,{edge:"start",color:"inherit","aria-label":"menu"}),Object(u.jsx)(d.a,{variant:"h6",color:"inherit",children:"The address book"})]})})}var p=n(14),b=n(12),O=n(17),h=n(226),f=n(215),m=n(216),x=n(228),v=n(24),y=n.n(v),g=n(39),I=n(107),S=n.n(I).a.create({baseURL:"https://dispex.org/api/vtest/"}),E=function(){return S.get("Request/streets")},w=function(e){return S.get("Request/houses/".concat(e))},C=function(e){return S.get("Request/house_flats/".concat(e))},T=function(e){return S.get("HousingStock/clients?addressId=".concat(e))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",r=arguments.length>4?arguments[4]:void 0;return S.post("HousingStock/client",{Id:e,Name:t,Phone:n,Email:a,BindId:r})},k=function(e){var t=e.AddressId,n=e.ClientId;return console.log(t,n),S.put("HousingStock/bind_client",{AddressId:t,ClientId:n})},A=function(e){return S.delete("HousingStock/bind_client/".concat(e))},D="SET_HOUSES",L="SET_STREETS",F="SET_HOUSE_FLAT",P="SET_CURRENT_ADDRESS",R="SET_CURRENT_ADDRESS_ID",N={houses:[],streets:[],houseFlat:[],currentAddress:null,currentAddressID:0},B="POST_CLIENT_DATA",q="SET_LOADING",U="SET_STATUS",H="SET_FLAT_CLIENTS",z="DELETE_FLAT_CLIENTS",V={clientID:null,isLoading:!1,status:"idle",flatClients:[{id:0,name:"\u0418\u0432\u0430\u043d",phone:"+7 932 324 12",email:"test@mail.com",bindId:0},{id:2,name:"\u0411\u043e\u0440\u0438\u0441",phone:"+7 932 324 12",email:"test@mail.com",bindId:3},{id:4,name:"\u0411\u043e\u0440\u0438\u0441",phone:"+7 932 324 12",email:"test@mail.com",bindId:3},{id:5,name:"\u0418\u043b\u044c\u044f",phone:"+7 922 789 78",email:"test@mail.com",bindId:3}]},M=function(e){return{type:B,payload:e}},W=function(e){return{type:q,payload:e}},G=function(e){return{type:U,payload:e}},J=function(e){return{type:z,payload:e}},X=function(){return function(){var e=Object(g.a)(y.a.mark((function e(t,n){var a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n().address.currentAddressID,e.prev=1,e.next=4,T(a);case 4:r=e.sent,t((c=r.data,{type:H,payload:c})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}var c}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()},K=function(e){return function(){var t=Object(g.a)(y.a.mark((function t(n){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A(e);case 3:n(J(e)),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()};function Q(){var e=Object(O.c)((function(e){return e.address.streets})),t=Object(O.c)((function(e){return e.address.houses})),n=Object(O.c)((function(e){return e.address.houseFlat})),r=Object(O.b)(),c=Object(a.useState)(null),i=Object(b.a)(c,2),o=i[0],l=i[1],d=Object(a.useState)(null),j=Object(b.a)(d,2),p=j[0],f=j[1],m=Object(a.useState)(null),x=Object(b.a)(m,2),v=x[0],y=x[1],g=null===v;return Object(u.jsxs)(s.a,{direction:"row",spacing:2,children:[Object(u.jsx)(Y,{setSearchTerm:l,dispatch:r,streets:e}),Object(u.jsx)(Z,{streetID:o,setSearchTerm:f,dispatch:r,houses:t}),Object(u.jsx)($,{houseID:p,setSearchTerm:y,houseFlat:n,dispatch:r}),Object(u.jsx)(h.a,{disabled:g,onClick:function(){var e,t;r((e=[o.nameWithPrefix,p.name,v.name],{type:P,payload:e})),r((t=v.id,{type:R,payload:t})),r(X())},children:" \u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0410\u0434\u0440\u0435\u0441"})]})}function Y(e){var t=e.setSearchTerm,n=e.streets,r=e.dispatch,c=Object(a.useState)(!1),s=Object(b.a)(c,2),i=s[0],o=s[1],l=i&&0===n.length;Object(a.useEffect)((function(){l&&r(function(){var e=Object(g.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E();case 3:n=e.sent,t((a=n.data,{type:L,payload:a})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}var a}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[l]);var d=n.filter((function(e){return 1===e.cityId}));return Object(u.jsx)(f.a,{id:"streets",sx:{width:300},open:i,onOpen:function(){o(!0)},onClose:function(){o(!1)},onChange:function(e,n){return n&&t(n)},options:d,loading:l,getOptionLabel:function(e){return e&&e.name},isOptionEqualToValue:function(e,t){return e.name===t.name},renderOption:function(e,t){return Object(a.createElement)("li",Object(p.a)(Object(p.a)({},e),{},{key:t.id}),t.name)},renderInput:function(e){return Object(u.jsx)(m.a,Object(p.a)(Object(p.a)({},e),{},{label:"\u0423\u043b\u0438\u0446\u0430",InputProps:Object(p.a)(Object(p.a)({},e.InputProps),{},{endAdornment:Object(u.jsxs)(u.Fragment,{children:[l?Object(u.jsx)(x.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})}function Z(e){var t=e.setSearchTerm,n=e.streetID,r=e.houses,c=e.dispatch,s=Object(a.useState)(!1),i=Object(b.a)(s,2),o=i[0],l=i[1],d=o&&0===r.length;return Object(a.useEffect)((function(){var e;n&&c((e=n.id,function(){var t=Object(g.a)(y.a.mark((function t(n){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w(e);case 3:a=t.sent,n((r=a.data,{type:D,payload:r})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}var r}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[n]),Object(u.jsx)(f.a,{id:"houses",sx:{width:200},open:o,onOpen:function(){l(!0)},onClose:function(){l(!1)},onChange:function(e,n){return n&&t(n)},options:r,loading:d,getOptionLabel:function(e){return e&&e.name},isOptionEqualToValue:function(e,t){return e.name===t.name},renderOption:function(e,t){return Object(a.createElement)("li",Object(p.a)(Object(p.a)({},e),{},{key:t.id}),t.name)},renderInput:function(e){return Object(u.jsx)(m.a,Object(p.a)(Object(p.a)({},e),{},{label:"\u0414\u043e\u043c",InputProps:Object(p.a)(Object(p.a)({},e.InputProps),{},{endAdornment:Object(u.jsxs)(u.Fragment,{children:[d?Object(u.jsx)(x.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})}function $(e){var t=e.setSearchTerm,n=e.houseID,r=e.houseFlat,c=e.dispatch,s=Object(a.useState)(!1),i=Object(b.a)(s,2),o=i[0],l=i[1],d=o&&0===r.length;return Object(a.useEffect)((function(){var e;n&&c((e=n.id,function(){var t=Object(g.a)(y.a.mark((function t(n){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C(e);case 3:a=t.sent,n((r=a.data,{type:F,payload:r})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}var r}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[n]),Object(u.jsx)(f.a,{id:"houses_flat",sx:{width:200},open:o,onOpen:function(){l(!0)},onClose:function(){l(!1)},onChange:function(e,n){n&&t(n)},options:r,loading:d,getOptionLabel:function(e){return e&&e.name},isOptionEqualToValue:function(e,t){return e&&e.name===t.name},renderOption:function(e,t){return Object(a.createElement)("li",Object(p.a)(Object(p.a)({},e),{},{key:t.id}),t.name)},renderInput:function(e){return Object(u.jsx)(m.a,Object(p.a)(Object(p.a)({},e),{},{label:"\u041a\u0432./\u043e\u0444\u0438\u0441",InputProps:Object(p.a)(Object(p.a)({},e.InputProps),{},{endAdornment:Object(u.jsxs)(u.Fragment,{children:[d?Object(u.jsx)(x.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})}var ee=n(217),te=n(229),ne=n(88),ae=n.n(ne),re=n(227),ce=n(113);var se=function(e){var t=e.handleClose,n=e.formButtonTitle,a=e.id,r=e.name,c=e.phone,s=e.email,i=e.bindId,o=Object(O.b)(),l=Object(O.c)((function(e){return e.houses.isLoading})),d=Object(O.c)((function(e){return e.address.currentAddressID})),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9999;return Math.floor(Math.random()*(t-e)+e)},b=Object(ce.a)({initialValues:{email:s||"",name:r||"",phone:c||""},onSubmit:function(e,t){var n;o((n={id:a||j(),name:e.name,phone:e.phone,email:e.email,address:i||d},function(){var e=Object(g.a)(y.a.mark((function e(t,a){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(W(!0)),t(G("loading")),e.prev=2,e.next=5,_(n.id,n.name,n.phone,n.email,n.address);case 5:if("Ok"!==e.sent.data.result){e.next=11;break}return t(M(n.id)),e.next=10,k({AddressId:n.address,ClientId:n.id});case 10:t(X());case 11:t(G("success")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0);case 17:return e.prev=17,t(W(!1)),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()))},validate:function(e){var t={};return e.phone||(t.phone="Required"),t}});return Object(u.jsx)("form",{className:ae.a.formWrap,onSubmit:b.handleSubmit,children:Object(u.jsxs)(re.a,{children:[Object(u.jsxs)("div",{className:ae.a.form,children:[Object(u.jsxs)("div",{children:[Object(u.jsx)(m.a,Object(p.a)({style:{width:"50%"},placeholder:"\u0424.\u0418.\u041e.",name:"name"},b.getFieldProps("name"))),Object(u.jsx)(m.a,Object(p.a)({style:{width:"50%"},placeholder:"e-mail",name:"email"},b.getFieldProps("email"))),b.touched.email&&b.errors.email?Object(u.jsx)("div",{style:{color:"red"},children:b.errors.email}):null]}),Object(u.jsx)(m.a,Object(p.a)({color:"secondary",required:!0,placeholder:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",name:"phone"},b.getFieldProps("phone"))),b.touched.phone&&b.errors.phone?Object(u.jsx)("div",{style:{color:"red"},children:b.errors.phone}):null]}),Object(u.jsx)("hr",{style:{width:"100%"}}),Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginRop:"40px"},children:[Object(u.jsx)(h.a,{style:{marginRight:"5px"},onClick:t,children:" \u041e\u0442\u043c\u0435\u043d\u0430 "}),Object(u.jsxs)(h.a,{variant:"contained",disabled:l,type:"submit",children:[" ",n," "]}),l?Object(u.jsx)(x.a,{style:{margin:"5px 0 0 5px"},color:"inherit",size:20}):null]})]})})};function ie(e){var t=e.currentAddress,n=e.title,r=e.disabled,c=void 0!==r&&r,i=e.isOpen,o=void 0!==i&&i,l=e.display,j=e.setIsOpen,p=e.id,f=e.name,m=e.phone,x=e.email,v=e.bindId,y=e.formButtonTitle,g=e.displayDelButton,I=void 0===g?"block":g;Object(a.useEffect)((function(){C(o)}),[o]);var S=Object(a.useState)(o),E=Object(b.a)(S,2),w=E[0],C=E[1],T=function(){C(!1),j&&j(!1)},_=Object(O.b)();return Object(u.jsxs)("div",{children:[Object(u.jsx)(h.a,{style:{display:l},disabled:c,variant:"contained",onClick:function(){return C(!0)},children:n}),Object(u.jsx)(ee.a,{open:w,onClose:T,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(u.jsxs)(te.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4},children:[Object(u.jsxs)(s.a,{direction:"row",justifyContent:"space-between",spacing:2,children:[Object(u.jsx)(d.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(u.jsx)("div",{children:Object(u.jsx)(h.a,{style:{display:I},onClick:function(){_(K(p)),T()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})]}),Object(u.jsx)(d.a,{id:"modal-modal-description",sx:{mt:2},children:t}),Object(u.jsx)(se,{bindId:v,name:f,email:x,phone:m,id:p,formButtonTitle:y,handleClose:T})]})})]})}var oe=n(222),le=n(220),de=n(219);function ue(){var e=Object(O.c)((function(e){return e.houses.status})),t=Object(O.b)(),n=function(e,n){"clickaway"===n&&t(G("idle")),t(G("idle"))};return Object(u.jsx)(le.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:"success"===e,onClose:n,autoHideDuration:2e3,children:Object(u.jsx)(de.a,{elevation:6,variant:"filled",onClose:n,severity:"success",children:"\u0414\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u044b."})})}var je=n(111),pe=n.n(je),be=n(110),Oe=n.n(be),he=n(214);var fe=function(){var e=Object(O.c)((function(e){return e.address.currentAddress})),t=Object(O.c)((function(e){return e.houses.flatClients})),n=Object(O.b)(),a=e&&e.map((function(t,n){return e[e.length-1]===t?Object(u.jsxs)("span",{children:[" ",t," "]},n):Object(u.jsxs)("span",{children:[" ",t," ,"]},n)}));return Object(u.jsxs)(s.a,{direction:"column",spacing:4,children:[Object(u.jsx)(ue,{}),Object(u.jsxs)(s.a,{direction:"row",justifyContent:"space-between",spacing:15,children:[Object(u.jsx)("div",{style:{padding:"10px"},children:e&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("span",{children:" \u0410\u0434\u0440\u0435\u0441: "}),Object(u.jsx)("span",{style:{marginLeft:"10px"},children:a})]})}),Object(u.jsxs)(s.a,{direction:"row",spacing:2,children:[Object(u.jsx)(h.a,{onClick:function(){n(X())},children:" \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435"}),Object(u.jsx)(ie,{displayDelButton:"none",formButtonTitle:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430",currentAddress:a})]})]}),Object(u.jsx)(oe.a,{style:{display:t?"flex":"none",padding:"23px 0"},elevation:5,children:Object(u.jsx)("div",{className:Oe.a.clientsList,children:t&&t.map((function(e){return Object(u.jsx)(me,{currentAddress:a,id:e.id,name:e.name,email:e.email,phone:e.phone,bindId:e.bindId},e.id)}))})})]})};function me(e){var t=e.name,n=e.phone,r=e.email,c=e.id,i=e.currentAddress,o=e.bindId,d=Object(a.useState)(!1),j=Object(b.a)(d,2),p=j[0],h=j[1],f=Object(O.b)(),m=t.length>0?t:"\u0418\u043c\u044f \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e",x=r.length>0?t:"Email \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d";return Object(u.jsxs)(oe.a,{style:{margin:"10px 0 0 20px"},elevation:5,children:[Object(u.jsx)(ie,{bindId:o,name:t,email:r,phone:n,id:c,setIsOpen:h,isOpen:p,currentAddress:i,disabled:!0,display:"none",formButtonTitle:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(u.jsxs)(s.a,{style:{padding:"20px"},direction:"column",justifyContent:"space-between",spacing:2,children:[Object(u.jsxs)("span",{children:["\u0418\u043c\u044f: ",Object(u.jsxs)("span",{style:{fontStyle:r.length>0?"":"Italic"},children:[m," "]})]}),Object(u.jsxs)("span",{children:["\u0422\u0435\u043b\u0435\u0444\u043e\u043d: ",n]}),Object(u.jsxs)("span",{children:["E-mail: ",Object(u.jsxs)("span",{style:{fontStyle:t.length>0?"":"Italic"},children:[x," "]})]})]}),Object(u.jsxs)(s.a,{style:{backgroundColor:"rgb(231 231 231)",padding:"20px"},direction:"row",justifyContent:"space-between",spacing:2,children:[Object(u.jsx)(l.a,{onClick:function(){f(K(c))},children:Object(u.jsx)(he.a,{})}),Object(u.jsx)(l.a,{onClick:function(){h(!p)},children:Object(u.jsx)(pe.a,{})})]})]})}var xe=function(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(s.a,{alignItems:"center",spacing:21,children:[Object(u.jsx)(j,{}),Object(u.jsxs)(s.a,{style:{width:"900px",margin:"45px"},alignItems:"flex-end",spacing:5,children:[Object(u.jsx)(Q,{}),Object(u.jsx)(fe,{})]})]})})},ve=n(77),ye=n(112),ge=n(77),Ie=(0,ge.createStore)((0,ge.combineReducers)({address:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(p.a)(Object(p.a)({},e),{},{houses:t.payload});case L:return Object(p.a)(Object(p.a)({},e),{},{streets:t.payload});case F:return Object(p.a)(Object(p.a)({},e),{},{houseFlat:t.payload});case P:return Object(p.a)(Object(p.a)({},e),{},{currentAddress:t.payload});case R:return Object(p.a)(Object(p.a)({},e),{},{currentAddressID:t.payload});default:return e}},houses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return Object(p.a)(Object(p.a)({},e),{},{clientID:t.payload});case q:return Object(p.a)(Object(p.a)({},e),{},{isLoading:t.payload});case U:return Object(p.a)(Object(p.a)({},e),{},{status:t.payload});case H:return Object(p.a)(Object(p.a)({},e),{},{flatClients:t.payload});case z:return Object(p.a)(Object(p.a)({},e),{},{flatClients:e.flatClients.filter((function(e){return e.id!==t.payload}))});default:return e}}}),(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ve.compose)(Object(ve.applyMiddleware)(ye.a)));window.store=Ie,c.a.render(Object(u.jsx)(O.a,{store:Ie,children:Object(u.jsx)(xe,{})}),document.getElementById("root"))},88:function(e,t,n){e.exports={formWrap:"Form_formWrap__3pKlD",form:"Form_form__Ui_Gb"}}},[[164,1,2]]]);
//# sourceMappingURL=main.a99fa8a6.chunk.js.map